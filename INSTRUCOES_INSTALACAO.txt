========================================
SISTEMA DE FACE ID - INSTRU√á√ïES DE INSTALA√á√ÉO
========================================

üì¶ Pacote: face_id_26122024.zip
üìÖ Data: 26/12/2024
üéØ Objetivo: Implementar reconhecimento facial para visitantes

========================================
ARQUIVOS INCLU√çDOS
========================================

1. create_face_descriptors.sql (6 KB)
   - Script SQL para criar tabelas

2. api_face_id.php (11 KB)
   - API REST para Face ID

3. cadastro_face_id.html (15 KB)
   - P√°gina de cadastro via link √∫nico

4. README_FACE_ID.md (25 KB)
   - Documenta√ß√£o completa

========================================
PASSO 1: BANCO DE DADOS
========================================

1. Acesse phpMyAdmin
2. Selecione o banco "inlaud99_erpserra"
3. Clique na aba "SQL"
4. Abra o arquivo "create_face_descriptors.sql"
5. Copie todo o conte√∫do
6. Cole no phpMyAdmin
7. Clique em "Executar"

‚úÖ Tabelas criadas:
   - face_descriptors
   - validacoes_face_id
   - vw_face_descriptors_ativos
   - vw_estatisticas_face_id

========================================
PASSO 2: UPLOAD DOS ARQUIVOS
========================================

Via cPanel File Manager:

1. Acesse File Manager
2. Navegue at√© /public_html/
3. Fa√ßa upload dos arquivos:
   - api_face_id.php
   - cadastro_face_id.html

‚úÖ URLs criadas:
   - https://seusite.com/api_face_id.php
   - https://seusite.com/cadastro_face_id.html

========================================
PASSO 3: TESTAR CADASTRO
========================================

1. Gerar token de teste via API:

   POST https://seusite.com/api_face_id.php?action=gerar_token
   Body: {
       "visitante_id": 1,
       "validade_horas": 48
   }

2. Copiar link retornado

3. Acessar link no celular

4. Permitir acesso √† c√¢mera

5. Capturar face

6. Verificar se descritor foi salvo:

   SELECT * FROM face_descriptors WHERE token_usado = 1;

========================================
PASSO 4: ATUALIZAR VISITANTES.HTML
========================================

‚ö†Ô∏è IMPORTANTE: C√≥digo fornecido no README_FACE_ID.md

Adicionar:
- Op√ß√£o "Face ID" no tipo de identifica√ß√£o
- Bot√£o "Gerar Link de Cadastro"
- Bot√£o "Copiar Link"
- Bot√£o "Enviar via WhatsApp"

Ver se√ß√£o "Implementa√ß√£o Pendente" no README.

========================================
PASSO 5: ATUALIZAR CONSOLE_ACESSO.HTML
========================================

‚ö†Ô∏è IMPORTANTE: C√≥digo fornecido no README_FACE_ID.md

Adicionar:
- Bot√£o "Face ID" no menu
- Modal de valida√ß√£o facial
- C√¢mera frontal
- Detec√ß√£o em tempo real
- Compara√ß√£o de descritores

Ver se√ß√£o "Implementa√ß√£o Pendente" no README.

========================================
PASSO 6: TESTAR VALIDA√á√ÉO
========================================

1. Abrir console_acesso.html no tablet

2. Clicar em "Face ID"

3. Posicionar rosto cadastrado

4. Aguardar reconhecimento

5. Verificar se acesso foi liberado

6. Verificar registro:

   SELECT * FROM validacoes_face_id ORDER BY data_validacao DESC LIMIT 10;

========================================
CONFIGURA√á√ïES
========================================

1. Threshold de Similaridade (padr√£o: 0.6)

   Editar em console_acesso.html:
   
   if (menorDistancia < 0.6) {  // Ajustar aqui
       // Acesso liberado
   }

   - Mais restritivo: 0.5
   - Menos restritivo: 0.7

2. Validade do Link (padr√£o: 48 horas)

   Editar em api_face_id.php:
   
   $validade_horas = $dados['validade_horas'] ?? 48;  // Ajustar aqui

========================================
TROUBLESHOOTING
========================================

‚ùå Erro: "C√¢mera n√£o funciona"
‚úÖ Solu√ß√£o: Verificar HTTPS (obrigat√≥rio para c√¢mera)

‚ùå Erro: "Modelos n√£o carregam"
‚úÖ Solu√ß√£o: Verificar conex√£o com CDN:
   https://cdn.jsdelivr.net/npm/@vladmandic/face-api@1.7.12/model

‚ùå Erro: "Nenhum rosto detectado"
‚úÖ Solu√ß√£o: 
   - Melhorar ilumina√ß√£o
   - Aproximar rosto da c√¢mera
   - Verificar se modelos foram carregados

‚ùå Erro: "Token inv√°lido"
‚úÖ Solu√ß√£o: 
   - Verificar se token existe no banco
   - Verificar se token n√£o expirou
   - Verificar se token n√£o foi usado

‚ùå Erro: "Similaridade muito baixa"
‚úÖ Solu√ß√£o:
   - Recadastrar face com melhor qualidade
   - Ajustar threshold
   - Verificar ilumina√ß√£o

========================================
QUERIES √öTEIS
========================================

-- Total de Face IDs cadastrados
SELECT COUNT(*) FROM face_descriptors WHERE token_usado = 1;

-- Taxa de sucesso
SELECT 
    COUNT(CASE WHEN resultado = 'sucesso' THEN 1 END) * 100.0 / COUNT(*) AS taxa_sucesso
FROM validacoes_face_id;

-- M√©dia de similaridade
SELECT AVG(similaridade) FROM validacoes_face_id WHERE resultado = 'sucesso';

-- √öltimas valida√ß√µes
SELECT 
    v.nome AS visitante,
    vf.similaridade,
    vf.resultado,
    vf.data_validacao
FROM validacoes_face_id vf
INNER JOIN visitantes v ON vf.visitante_id = v.id
ORDER BY vf.data_validacao DESC
LIMIT 20;

-- Limpar tokens expirados
DELETE FROM face_descriptors 
WHERE token_usado = 0 
AND data_expiracao < NOW();

========================================
PR√ìXIMOS PASSOS
========================================

1. ‚úÖ Executar SQL
2. ‚úÖ Upload dos arquivos
3. ‚úÖ Testar cadastro
4. ‚è≥ Atualizar visitantes.html
5. ‚è≥ Atualizar console_acesso.html
6. ‚è≥ Testar valida√ß√£o

========================================
SUPORTE
========================================

üìö Documenta√ß√£o completa: README_FACE_ID.md
üîó GitHub: https://github.com/andreprogramadorbh-ai/erpserra
üìß D√∫vidas: Consultar README_FACE_ID.md

========================================
FIM DAS INSTRU√á√ïES
========================================
