<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Fornecedor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
.container { max-width: 1200px; margin: 0 auto; padding: 20px; }
.card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.btn { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
.btn-primary { background: #007bff; color: white; }
.btn-success { background: #28a745; color: white; }
.btn-danger { background: #dc3545; color: white; }
.btn-warning { background: #ffc107; color: #000; }
.form-group { margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 5px; font-weight: 600; }
.form-control { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
.table { width: 100%; border-collapse: collapse; }
.table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
.table th { background: #f8f9fa; font-weight: 600; }
.badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; }
.badge-success { background: #d4edda; color: #155724; }
.badge-warning { background: #fff3cd; color: #856404; }
.badge-danger { background: #f8d7da; color: #721c24; }
.badge-info { background: #d1ecf1; color: #0c5460; }
.stars { color: #ffc107; }
.header { background: #343a40; color: white; padding: 15px 0; margin-bottom: 20px; }
.header h1 { font-size: 24px; }
.nav { list-style: none; display: flex; gap: 20px; margin-top: 10px; }
.nav a { color: white; text-decoration: none; }
.nav a:hover { text-decoration: underline; }
.alert { padding: 15px; border-radius: 4px; margin-bottom: 20px; }
.alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
.alert-danger { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
.grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
.rating { display: flex; gap: 5px; }
.rating i { cursor: pointer; }
</style>

    <script src="js/sessao_manager.js"></script>
</head>
<body>
    <div class="header">
        <div class="main-container">
            <h1><i class="fas fa-store"></i> Painel do Fornecedor</h1>
            <ul class="nav">
                <li><a href="painel_fornecedor.html"><i class="fas fa-home"></i> Início</a></li>
                <li><a href="fornecedor_produtos.html"><i class="fas fa-box"></i> Produtos/Serviços</a></li>
                <li><a href="fornecedor_pedidos.html"><i class="fas fa-shopping-cart"></i> Pedidos</a></li>
                <li><a href="fornecedor_perfil.html"><i class="fas fa-user"></i> Perfil</a></li>
                <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</a></li>
            </ul>
        </div>
    </div>
    <div class="main-container">
        <div class="grid">
            <div class="card">
                <h3><i class="fas fa-box"></i> Produtos/Serviços</h3>
                <p style="font-size:32px; font-weight:bold;" id="totalProdutos">0</p>
            </div>
            <div class="card">
                <h3><i class="fas fa-shopping-cart"></i> Pedidos Novos</h3>
                <p style="font-size:32px; font-weight:bold; color:#ffc107;" id="pedidosNovos">0</p>
            </div>
            <div class="card">
                <h3><i class="fas fa-star"></i> Avaliação Média</h3>
                <p style="font-size:32px; font-weight:bold; color:#28a745;" id="mediaAvaliacoes">0.0</p>
            </div>
        </div>
        <div class="card">
            <h3>Últimos Pedidos</h3>
            <table class="table" id="tabelaPedidos">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Morador</th>
                        <th>Produto/Serviço</th>
                        <th>Status</th>
                        <th>Data</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <script>
        async function carregarDados() {
            // Simulado - precisa implementar sessão
            const fornecedorId = 1;
            
            const res = await fetch(`api/api_pedidos.php?acao=listar_fornecedor&fornecedor_id=${fornecedorId}`);
            const data = await res.json();
            
            if (data.sucesso) {
                const tbody = document.querySelector('#tabelaPedidos tbody');
                tbody.innerHTML = '';
                data.dados.forEach(pedido => {
                    tbody.innerHTML += `
                        <tr>
                            <td>${pedido.id}</td>
                            <td>${pedido.morador_nome}</td>
                            <td>${pedido.produto_servico_nome || 'N/A'}</td>
                            <td><span class="badge badge-warning">${pedido.status}</span></td>
                            <td>${new Date(pedido.data_pedido).toLocaleDateString()}</td>
                            <td><a href="fornecedor_pedidos.html?id=${pedido.id}" class="btn btn-primary">Ver</a></td>
                        </tr>
                    `;
                });
            }
        }
        
        function logout() {
            if (confirm('Deseja sair?')) {
                fetch('../api/api_login_fornecedor.php', { method: 'POST', body: new FormData().append('acao', 'logout') });
                window.location.href = 'login_fornecedor.html';
            }
        }
        
        carregarDados();
    </script>
</body>
</html>